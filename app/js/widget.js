function gotoPin(o){var n=$(".wrapper .pin");n.removeClass("current").eq(o).addClass("current")}Api={isFollow:function(o){return o({status:"1"})},isLogin:function(o){$.ajax({url:"/api/islogin",type:"POST",dataType:"json",success:function(n){return o(n)}})},ifShared:function(){$.ajax({url:"/api/share",type:"POST",dataType:"json",success:function(){}})},writeGreeting:function(o,n){$.ajax({url:"/api/greeting",type:"POST",dataType:"json",data:o,success:function(o){return n(o)}})},ballot:function(o,n){$.ajax({url:"/api/ballot",type:"POST",dataType:"json",data:o,success:function(o){return n(o)}})},sendVerifycode:function(o,n){$.ajax({url:"/api/sendverifycode",type:"POST",dataType:"json",data:o,success:function(o){return n(o)}})},customerBind:function(o,n){$.ajax({url:"/api/customerbind",type:"POST",dataType:"json",data:o,success:function(o){return n(o)}})},customerRegister:function(o,n){$.ajax({url:"/api/customerregister",type:"POST",dataType:"json",data:o,success:function(o){return n(o)}})},galleryList:function(o,n){$.ajax({url:"/api/list",type:"POST",dataType:"json",data:o,success:function(o){return n(o)}})}},function(){var o=navigator.userAgent.toLowerCase(),n={goHomepage:function(){gotoPin(0)},goWriteGreetingPage:function(){gotoPin(1)},goMyPhotoPage:function(){gotoPin(5)},goGallerypage:function(){window.location.href="gallery.html"},goMobilePage:function(){gotoPin(2)},goInfoPage:function(){gotoPin(3)},isWx:function(){return!!/micromessenger/.test(o)},msgBox:function(o,n){n?$("body").append('<div class="ajaxpop msgbox minwidthbox"><div class="loading">'+o+"</div></div>"):$("body").append('<div class="ajaxpop msgbox"><div class="loading"><div class="icon-loading"></div>'+o+"</div></div>")},errorMsg:{add:function(o,n){o.find(".error").length?o.find(".error").html(n):o.append('<div class="error">'+n+"</div>")},remove:function(o){o.find(".error").length&&o.find(".error").remove()}}};this.Common=n}.call(this),function(){"use strict";var o=function(){this.curPage=0,this.selectedColor=""};o.prototype={init:function(){var o=this;$(".loading-wrap").addClass("show");var n="/app",e=[n+"/images/qrcode-share.png"];new preLoader(e,{onProgress:function(){},onComplete:function(){$(".preloading").remove(1e3),Common.goHomepage(),Api.isFollow(function(o){console.log(o),1==o.status||$(".qrcode-follow-pop").removeClass("hide")}),$("#input-tocoach").keypress(function(n){if("13"==n.keyCode){var e=$(this).val();o.outputMsg(1,"/app/images/loading-logo.png",e),o.compareCommand(e),$(this).val(""),$(".pin-inner").scrollTop($(".conversation-list").height())}}),$(".wrapper").on("click",".btn-share",function(){$(".popup").addClass("hide"),$(".share-pop").removeClass("hide")}),$(".share-1").on("click",function(){o.showShareQrcode()})}})},compareCommand:function(o){for(var n=this,e=["520","1314","1234"],a=0;a<e.length;a++){if(o==e[a])return n.outputMsg(2,"/app/images/loading-logo.png","么么哒~COACH收到你的真情告白啦，马上为你送上专属的520优惠券，爱你哟！"),n.outputMsg(3,"/app/images/loading-logo.png","么么哒~COACH收到你的真情告白啦，马上为你送上专属的520优惠券，爱你哟！"),void n.outputMsg(2,"/app/images/loading-logo.png",'点击领取卡券，<span class="btn-share">分享</span>后更有机会领取520现金红包哦！');a==e.length-1&&n.outputMsg(2,"/app/images/loading-logo.png","爱的信号有误，COACH无法回应你的爱意哦！")}},outputMsg:function(o,n,e){var a="";1==o?a='<li class="item item-right animate fade"><div class="avatar"><img src="'+n+'" alt=""/></div><div class="words">'+e+"</div></li>":2==o?a='<li class="item item-left animate fade"><div class="avatar"><img src="'+n+'" alt=""/></div><div class="words">'+e+"</div></li>":3==o&&(a='<li class="item item-left animate fade"><img src="/app/images/coupon.png" alt=""/></li>'),$(".conversation-list").append(a)},showShareQrcode:function(){$(".popup").addClass("hide"),$(".qrcode-share-pop").removeClass("hide"),Api.ifShared(),wx.ready(function(){wx.onMenuShareTimeline({title:"520，土豪Coach用现金红包爱你",link:window.location.href,imgUrl:window.location.origin+"/app/images/share-guide.png",success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:"520，土豪Coach用现金红包爱你",desc:"520，土豪Coach用现金红包爱你",link:window.location.href,imgUrl:window.location.origin+"/app/images/share-guide.png",type:"",dataUrl:"",success:function(){},cancel:function(){}})})},radomGreetingBg:function(){var o=Math.round(4*Math.random()+1);$(".photo-frame").attr("class","photo-frame photo photo-"+o)},generateGreeting:function(){Common.msgBox("loading..."),$(".share-pop").removeClass("hide")},MobileValidate:function(){var o=!0,n=$(".form-validate .input-phone");if(n.val()){var e=/^1\d{10}$/;e.test(n.val())?Common.errorMsg.remove(n.parent()):(o=!1,Common.errorMsg.add(n.parent(),"手机号格式错误，请重新输入"))}else Common.errorMsg.add(n.parent(),"手机号码不能为空"),o=!1;return!!o},FormKeycodeValidate:function(){var o=!0,n=$(".form-validate .input-phone"),e=$(".form-validate .input-keycode");if(n.val()){var a=/^1\d{10}$/;a.test(n.val())?Common.errorMsg.remove(n.parent()):(o=!1,Common.errorMsg.add(n.parent(),"手机号格式错误，请重新输入"))}else Common.errorMsg.add(n.parent(),"手机号码不能为空"),o=!1;return e.val()?Common.errorMsg.remove(e.parent()):(Common.errorMsg.add(e.parent(),"验证码不能为空"),o=!1),!!o},FormInforValidate:function(){var o=!0,n=$(".form-info .input-surname"),e=$(".form-info .input-name"),a=($("input[type='radio'][name='gender']:checked"),$(".form-info .input-mobile"),$(".form-info .input-email-pre")),i=$(".form-info .input-email-after");return n.val()?Common.errorMsg.remove(n.parent()):(Common.errorMsg.add(n.parent(),"姓不能为空"),o=!1),e.val()?Common.errorMsg.remove(e.parent()):(Common.errorMsg.add(e.parent(),"名不能为空"),o=!1),a.val()&&i.val()?Common.errorMsg.remove(a.parent()):(Common.errorMsg.add(a.parent(),"邮箱不能为空"),o=!1),!!o},SubmitKeycodeForm:function(){var o=this;$(".btn-getkeycode").on("click",function(n){if(n.preventDefault(),!($(".countdown").length>0)&&o.MobileValidate()){console.log("validate phone number");var e=$(".input-phone").val();o.countDown();$.ajax({type:"POST",url:"/api/check",data:{mobile:e},dataType:"json",success:function(o){console.log(o),1==o.status?console.log("短信发送成功"):alert(o.msg)}})}});var n=!0;$(".form-validate .form-btn-submit").on("click",function(){if(o.FormKeycodeValidate()){if(!n)return;n=!1;var e=$(".input-phone").val(),a=$(".input-keycode").val();console.log(e+"phonenumber"+a),Common.msgBox("loading...");$.ajax({type:"POST",url:"/api/submit",data:{mobile:e,code:a},dataType:"json",success:function(o){n=!0,$(".ajaxpop").remove(),console.log("do something...")}})}}),$(".privacy-term").on("click",function(){$(".term-pop").removeClass("hide").addClass("animate fade")}),o.closePop(),o.toMoneyPage()},SubmitInformationForm:function(){var o=this;$(".form-info .form-btn-submit").on("click",function(){o.FormInforValidate()&&console.log("validate success")})},countDown:function(){var o=59,n=setInterval(function(){o--,$(".btn-getkeycode").addClass("countdown").html(o),0>=o&&(clearInterval(n),$(".btn-getkeycode").removeClass("countdown").html(""))},1e3)},closePop:function(){$(".btn-close").on("click",function(){$(this).parent().addClass("hide")})},toMoneyPage:function(){var o=this;o.closePop(),$(".btn-get").on("click",function(){$(".qrcode-pop").removeClass("hide").addClass("animate fade")}),$(".btn-share").on("click",function(){$(".share-pop").removeClass("hide").addClass("animate fade")})}},"function"==typeof define&&define.amd?define(function(){return o}):this.controller=o}.call(this),$(document).ready(function(o){var n=new controller;n.init()}),function(o,n){var e=o.documentElement,a="orientationchange"in window?"orientationchange":"resize",i=function(){var o=e.clientWidth;window.innerHeight;o&&(e.style.fontSize=50*(o/375)+"px")};o.addEventListener&&(n.addEventListener(a,i,!1),i())}(document,window),$(document).ready(function(){wx.ready(function(){wx.onMenuShareTimeline({title:"520，土豪Coach用现金红包爱你",link:window.location.href,imgUrl:window.location.origin+"/app/images/share-guide.png",success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:"520，土豪Coach用现金红包爱你",desc:"520，土豪Coach用现金红包爱你",link:window.location.href,imgUrl:window.location.origin+"/app/images/share-guide.png",type:"",dataUrl:"",success:function(){},cancel:function(){}})})});